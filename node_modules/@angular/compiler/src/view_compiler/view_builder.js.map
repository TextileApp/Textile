{"version":3,"file":"view_builder.js","sourceRoot":"","sources":["../../../../../modules/@angular/compiler/src/view_compiler/view_builder.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {ViewEncapsulation} from '@angular/core';\n\nimport {CompileDirectiveMetadata, CompileDirectiveSummary, CompileIdentifierMetadata, CompileTokenMetadata} from '../compile_metadata';\nimport {createSharedBindingVariablesIfNeeded} from '../compiler_util/expression_converter';\nimport {createDiTokenExpression, createInlineArray} from '../compiler_util/identifier_util';\nimport {isPresent} from '../facade/lang';\nimport {Identifiers, identifierToken, resolveIdentifier} from '../identifiers';\nimport {createClassStmt} from '../output/class_builder';\nimport * as o from '../output/output_ast';\nimport {ParseSourceSpan} from '../parse_util';\nimport {ChangeDetectorStatus, ViewType, isDefaultChangeDetectionStrategy} from '../private_import_core';\nimport {AttrAst, BoundDirectivePropertyAst, BoundElementPropertyAst, BoundEventAst, BoundTextAst, DirectiveAst, ElementAst, EmbeddedTemplateAst, NgContentAst, ReferenceAst, TemplateAst, TemplateAstVisitor, TextAst, VariableAst, templateVisitAll} from '../template_parser/template_ast';\n\nimport {CompileElement, CompileNode} from './compile_element';\nimport {CompileView, CompileViewRootNode, CompileViewRootNodeType} from './compile_view';\nimport {ChangeDetectorStatusEnum, DetectChangesVars, InjectMethodVars, ViewConstructorVars, ViewEncapsulationEnum, ViewProperties, ViewTypeEnum} from './constants';\nimport {ComponentFactoryDependency, DirectiveWrapperDependency, ViewClassDependency} from './deps';\nimport {getViewClassName} from './util';\n\nconst IMPLICIT_TEMPLATE_VAR = '\\$implicit';\nconst CLASS_ATTR = 'class';\nconst STYLE_ATTR = 'style';\nconst NG_CONTAINER_TAG = 'ng-container';\n\nconst parentRenderNodeVar = o.variable('parentRenderNode');\nconst rootSelectorVar = o.variable('rootSelector');\n\nexport function buildView(\n    view: CompileView, template: TemplateAst[],\n    targetDependencies:\n        Array<ViewClassDependency|ComponentFactoryDependency|DirectiveWrapperDependency>): number {\n  const builderVisitor = new ViewBuilderVisitor(view, targetDependencies);\n  const parentEl =\n      view.declarationElement.isNull() ? view.declarationElement : view.declarationElement.parent;\n  templateVisitAll(builderVisitor, template, parentEl);\n  if (view.viewType === ViewType.EMBEDDED || view.viewType === ViewType.HOST) {\n    view.lastRenderNode = builderVisitor.getOrCreateLastRenderNode();\n  }\n  return builderVisitor.nestedViewCount;\n}\n\nexport function finishView(view: CompileView, targetStatements: o.Statement[]) {\n  view.afterNodes();\n  createViewTopLevelStmts(view, targetStatements);\n  view.nodes.forEach((node) => {\n    if (node instanceof CompileElement && node.hasEmbeddedView) {\n      finishView(node.embeddedView, targetStatements);\n    }\n  });\n}\n\nclass ViewBuilderVisitor implements TemplateAstVisitor {\n  nestedViewCount: number = 0;\n\n  constructor(\n      public view: CompileView,\n      public targetDependencies:\n          Array<ViewClassDependency|ComponentFactoryDependency|DirectiveWrapperDependency>) {}\n\n  private _isRootNode(parent: CompileElement): boolean { return parent.view !== this.view; }\n\n  private _addRootNodeAndProject(node: CompileNode) {\n    const projectedNode = _getOuterContainerOrSelf(node);\n    const parent = projectedNode.parent;\n    const ngContentIndex = (<any>projectedNode.sourceAst).ngContentIndex;\n    const viewContainer =\n        (node instanceof CompileElement && node.hasViewContainer) ? node.viewContainer : null;\n    if (this._isRootNode(parent)) {\n      if (this.view.viewType !== ViewType.COMPONENT) {\n        this.view.rootNodes.push(new CompileViewRootNode(\n            viewContainer ? CompileViewRootNodeType.ViewContainer : CompileViewRootNodeType.Node,\n            viewContainer || node.renderNode));\n      }\n    } else if (isPresent(parent.component) && isPresent(ngContentIndex)) {\n      parent.addContentNode(\n          ngContentIndex,\n          new CompileViewRootNode(\n              viewContainer ? CompileViewRootNodeType.ViewContainer : CompileViewRootNodeType.Node,\n              viewContainer || node.renderNode));\n    }\n  }\n\n  private _getParentRenderNode(parent: CompileElement): o.Expression {\n    parent = _getOuterContainerParentOrSelf(parent);\n    if (this._isRootNode(parent)) {\n      if (this.view.viewType === ViewType.COMPONENT) {\n        return parentRenderNodeVar;\n      } else {\n        // root node of an embedded/host view\n        return o.NULL_EXPR;\n      }\n    } else {\n      return isPresent(parent.component) &&\n              parent.component.template.encapsulation !== ViewEncapsulation.Native ?\n          o.NULL_EXPR :\n          parent.renderNode;\n    }\n  }\n\n  getOrCreateLastRenderNode(): o.Expression {\n    const view = this.view;\n    if (view.rootNodes.length === 0 ||\n        view.rootNodes[view.rootNodes.length - 1].type !== CompileViewRootNodeType.Node) {\n      const fieldName = `_el_${view.nodes.length}`;\n      view.fields.push(\n          new o.ClassField(fieldName, o.importType(view.genConfig.renderTypes.renderElement)));\n      view.createMethod.addStmt(o.THIS_EXPR.prop(fieldName)\n                                    .set(ViewProperties.renderer.callMethod(\n                                        'createTemplateAnchor', [o.NULL_EXPR, o.NULL_EXPR]))\n                                    .toStmt());\n      view.rootNodes.push(\n          new CompileViewRootNode(CompileViewRootNodeType.Node, o.THIS_EXPR.prop(fieldName)));\n    }\n    return view.rootNodes[view.rootNodes.length - 1].expr;\n  }\n\n  visitBoundText(ast: BoundTextAst, parent: CompileElement): any {\n    return this._visitText(ast, '', parent);\n  }\n  visitText(ast: TextAst, parent: CompileElement): any {\n    return this._visitText(ast, ast.value, parent);\n  }\n  private _visitText(ast: TemplateAst, value: string, parent: CompileElement): o.Expression {\n    const fieldName = `_text_${this.view.nodes.length}`;\n    this.view.fields.push(\n        new o.ClassField(fieldName, o.importType(this.view.genConfig.renderTypes.renderText)));\n    const renderNode = o.THIS_EXPR.prop(fieldName);\n    const compileNode = new CompileNode(parent, this.view, this.view.nodes.length, renderNode, ast);\n    const createRenderNode =\n        o.THIS_EXPR.prop(fieldName)\n            .set(ViewProperties.renderer.callMethod(\n                'createText',\n                [\n                  this._getParentRenderNode(parent), o.literal(value),\n                  this.view.createMethod.resetDebugInfoExpr(this.view.nodes.length, ast)\n                ]))\n            .toStmt();\n    this.view.nodes.push(compileNode);\n    this.view.createMethod.addStmt(createRenderNode);\n    this._addRootNodeAndProject(compileNode);\n    return renderNode;\n  }\n\n  visitNgContent(ast: NgContentAst, parent: CompileElement): any {\n    // the projected nodes originate from a different view, so we don't\n    // have debug information for them...\n    this.view.createMethod.resetDebugInfo(null, ast);\n    const parentRenderNode = this._getParentRenderNode(parent);\n    if (parentRenderNode !== o.NULL_EXPR) {\n      this.view.createMethod.addStmt(\n          o.THIS_EXPR.callMethod('projectNodes', [parentRenderNode, o.literal(ast.index)])\n              .toStmt());\n    } else if (this._isRootNode(parent)) {\n      if (this.view.viewType !== ViewType.COMPONENT) {\n        // store root nodes only for embedded/host views\n        this.view.rootNodes.push(\n            new CompileViewRootNode(CompileViewRootNodeType.NgContent, null, ast.index));\n      }\n    } else {\n      if (isPresent(parent.component) && isPresent(ast.ngContentIndex)) {\n        parent.addContentNode(\n            ast.ngContentIndex,\n            new CompileViewRootNode(CompileViewRootNodeType.NgContent, null, ast.index));\n      }\n    }\n    return null;\n  }\n\n  visitElement(ast: ElementAst, parent: CompileElement): any {\n    const nodeIndex = this.view.nodes.length;\n    let createRenderNodeExpr: o.Expression;\n    const debugContextExpr = this.view.createMethod.resetDebugInfoExpr(nodeIndex, ast);\n    const directives = ast.directives.map(directiveAst => directiveAst.directive);\n    const component = directives.find(directive => directive.isComponent);\n    if (ast.name === NG_CONTAINER_TAG) {\n      createRenderNodeExpr = ViewProperties.renderer.callMethod(\n          'createTemplateAnchor', [this._getParentRenderNode(parent), debugContextExpr]);\n    } else {\n      const htmlAttrs = _readHtmlAttrs(ast.attrs);\n      const attrNameAndValues = createInlineArray(\n          _mergeHtmlAndDirectiveAttrs(htmlAttrs, directives).map(v => o.literal(v)));\n      if (nodeIndex === 0 && this.view.viewType === ViewType.HOST) {\n        createRenderNodeExpr =\n            o.importExpr(resolveIdentifier(Identifiers.selectOrCreateRenderHostElement)).callFn([\n              ViewProperties.renderer, o.literal(ast.name), attrNameAndValues, rootSelectorVar,\n              debugContextExpr\n            ]);\n      } else {\n        createRenderNodeExpr =\n            o.importExpr(resolveIdentifier(Identifiers.createRenderElement)).callFn([\n              ViewProperties.renderer, this._getParentRenderNode(parent), o.literal(ast.name),\n              attrNameAndValues, debugContextExpr\n            ]);\n      }\n    }\n    const fieldName = `_el_${nodeIndex}`;\n    this.view.fields.push(\n        new o.ClassField(fieldName, o.importType(this.view.genConfig.renderTypes.renderElement)));\n    this.view.createMethod.addStmt(o.THIS_EXPR.prop(fieldName).set(createRenderNodeExpr).toStmt());\n\n    const renderNode = o.THIS_EXPR.prop(fieldName);\n\n    const compileElement = new CompileElement(\n        parent, this.view, nodeIndex, renderNode, ast, component, directives, ast.providers,\n        ast.hasViewContainer, false, ast.references, this.targetDependencies);\n    this.view.nodes.push(compileElement);\n    let compViewExpr: o.ReadPropExpr = null;\n    if (isPresent(component)) {\n      const nestedComponentIdentifier =\n          new CompileIdentifierMetadata({name: getViewClassName(component, 0)});\n      this.targetDependencies.push(\n          new ViewClassDependency(component.type, nestedComponentIdentifier));\n\n      compViewExpr = o.THIS_EXPR.prop(`compView_${nodeIndex}`);  // fix highlighting: `\n      this.view.fields.push(new o.ClassField(\n          compViewExpr.name,\n          o.importType(resolveIdentifier(Identifiers.AppView), [o.importType(component.type)])));\n      this.view.viewChildren.push(compViewExpr);\n      compileElement.setComponentView(compViewExpr);\n      this.view.createMethod.addStmt(\n          compViewExpr\n              .set(o.importExpr(nestedComponentIdentifier).instantiate([\n                ViewProperties.viewUtils, o.THIS_EXPR, o.literal(nodeIndex), renderNode\n              ]))\n              .toStmt());\n    }\n    compileElement.beforeChildren();\n    this._addRootNodeAndProject(compileElement);\n    templateVisitAll(this, ast.children, compileElement);\n    compileElement.afterChildren(this.view.nodes.length - nodeIndex - 1);\n\n    if (isPresent(compViewExpr)) {\n      this.view.createMethod.addStmt(\n          compViewExpr.callMethod('create', [compileElement.getComponent()]).toStmt());\n    }\n    return null;\n  }\n\n  visitEmbeddedTemplate(ast: EmbeddedTemplateAst, parent: CompileElement): any {\n    const nodeIndex = this.view.nodes.length;\n    const fieldName = `_anchor_${nodeIndex}`;\n    this.view.fields.push(\n        new o.ClassField(fieldName, o.importType(this.view.genConfig.renderTypes.renderComment)));\n    this.view.createMethod.addStmt(\n        o.THIS_EXPR.prop(fieldName)\n            .set(ViewProperties.renderer.callMethod(\n                'createTemplateAnchor',\n                [\n                  this._getParentRenderNode(parent),\n                  this.view.createMethod.resetDebugInfoExpr(nodeIndex, ast)\n                ]))\n            .toStmt());\n    const renderNode = o.THIS_EXPR.prop(fieldName);\n\n    const templateVariableBindings = ast.variables.map(\n        varAst => [varAst.value.length > 0 ? varAst.value : IMPLICIT_TEMPLATE_VAR, varAst.name]);\n\n    const directives = ast.directives.map(directiveAst => directiveAst.directive);\n    const compileElement = new CompileElement(\n        parent, this.view, nodeIndex, renderNode, ast, null, directives, ast.providers,\n        ast.hasViewContainer, true, ast.references, this.targetDependencies);\n    this.view.nodes.push(compileElement);\n\n    this.nestedViewCount++;\n    const embeddedView = new CompileView(\n        this.view.component, this.view.genConfig, this.view.pipeMetas, o.NULL_EXPR,\n        this.view.animations, this.view.viewIndex + this.nestedViewCount, compileElement,\n        templateVariableBindings);\n    this.nestedViewCount += buildView(embeddedView, ast.children, this.targetDependencies);\n\n    compileElement.beforeChildren();\n    this._addRootNodeAndProject(compileElement);\n    compileElement.afterChildren(0);\n\n    return null;\n  }\n\n  visitAttr(ast: AttrAst, ctx: any): any { return null; }\n  visitDirective(ast: DirectiveAst, ctx: any): any { return null; }\n  visitEvent(ast: BoundEventAst, eventTargetAndNames: Map<string, BoundEventAst>): any {\n    return null;\n  }\n\n  visitReference(ast: ReferenceAst, ctx: any): any { return null; }\n  visitVariable(ast: VariableAst, ctx: any): any { return null; }\n  visitDirectiveProperty(ast: BoundDirectivePropertyAst, context: any): any { return null; }\n  visitElementProperty(ast: BoundElementPropertyAst, context: any): any { return null; }\n}\n\n/**\n * Walks up the nodes while the direct parent is a container.\n *\n * Returns the outer container or the node itself when it is not a direct child of a container.\n *\n * @internal\n */\nfunction _getOuterContainerOrSelf(node: CompileNode): CompileNode {\n  const view = node.view;\n\n  while (_isNgContainer(node.parent, view)) {\n    node = node.parent;\n  }\n\n  return node;\n}\n\n/**\n * Walks up the nodes while they are container and returns the first parent which is not.\n *\n * Returns the parent of the outer container or the node itself when it is not a container.\n *\n * @internal\n */\nfunction _getOuterContainerParentOrSelf(el: CompileElement): CompileElement {\n  const view = el.view;\n\n  while (_isNgContainer(el, view)) {\n    el = el.parent;\n  }\n\n  return el;\n}\n\nfunction _isNgContainer(node: CompileNode, view: CompileView): boolean {\n  return !node.isNull() && (<ElementAst>node.sourceAst).name === NG_CONTAINER_TAG &&\n      node.view === view;\n}\n\n\nfunction _mergeHtmlAndDirectiveAttrs(\n    declaredHtmlAttrs: {[key: string]: string}, directives: CompileDirectiveSummary[]): string[] {\n  const mapResult: {[key: string]: string} = {};\n  Object.keys(declaredHtmlAttrs).forEach(key => { mapResult[key] = declaredHtmlAttrs[key]; });\n  directives.forEach(directiveMeta => {\n    Object.keys(directiveMeta.hostAttributes).forEach(name => {\n      const value = directiveMeta.hostAttributes[name];\n      const prevValue = mapResult[name];\n      mapResult[name] = isPresent(prevValue) ? mergeAttributeValue(name, prevValue, value) : value;\n    });\n  });\n  const arrResult: string[] = [];\n  // Note: We need to sort to get a defined output order\n  // for tests and for caching generated artifacts...\n  Object.keys(mapResult).sort().forEach(\n      (attrName) => { arrResult.push(attrName, mapResult[attrName]); });\n  return arrResult;\n}\n\nfunction _readHtmlAttrs(attrs: AttrAst[]): {[key: string]: string} {\n  const htmlAttrs: {[key: string]: string} = {};\n  attrs.forEach((ast) => { htmlAttrs[ast.name] = ast.value; });\n  return htmlAttrs;\n}\n\nfunction mergeAttributeValue(attrName: string, attrValue1: string, attrValue2: string): string {\n  if (attrName == CLASS_ATTR || attrName == STYLE_ATTR) {\n    return `${attrValue1} ${attrValue2}`;\n  } else {\n    return attrValue2;\n  }\n}\n\nfunction createViewTopLevelStmts(view: CompileView, targetStatements: o.Statement[]) {\n  let nodeDebugInfosVar: o.Expression = o.NULL_EXPR;\n  if (view.genConfig.genDebugInfo) {\n    nodeDebugInfosVar = o.variable(\n        `nodeDebugInfos_${view.component.type.name}${view.viewIndex}`);  // fix highlighting: `\n    targetStatements.push(\n        (<o.ReadVarExpr>nodeDebugInfosVar)\n            .set(o.literalArr(\n                view.nodes.map(createStaticNodeDebugInfo),\n                new o.ArrayType(\n                    new o.ExternalType(resolveIdentifier(Identifiers.StaticNodeDebugInfo)),\n                    [o.TypeModifier.Const])))\n            .toDeclStmt(null, [o.StmtModifier.Final]));\n  }\n\n\n  const renderCompTypeVar: o.ReadVarExpr =\n      o.variable(`renderType_${view.component.type.name}`);  // fix highlighting: `\n  if (view.viewIndex === 0) {\n    let templateUrlInfo: string;\n    if (view.component.template.templateUrl == view.component.type.moduleUrl) {\n      templateUrlInfo =\n          `${view.component.type.moduleUrl} class ${view.component.type.name} - inline template`;\n    } else {\n      templateUrlInfo = view.component.template.templateUrl;\n    }\n    targetStatements.push(\n        renderCompTypeVar\n            .set(o.importExpr(resolveIdentifier(Identifiers.createRenderComponentType)).callFn([\n              view.genConfig.genDebugInfo ? o.literal(templateUrlInfo) : o.literal(''),\n              o.literal(view.component.template.ngContentSelectors.length),\n              ViewEncapsulationEnum.fromValue(view.component.template.encapsulation),\n              view.styles,\n              o.literalMap(view.animations.map(\n                  (entry): [string, o.Expression] => [entry.name, entry.fnExp])),\n            ]))\n            .toDeclStmt(o.importType(resolveIdentifier(Identifiers.RenderComponentType))));\n  }\n\n  const viewClass = createViewClass(view, renderCompTypeVar, nodeDebugInfosVar);\n  targetStatements.push(viewClass);\n}\n\nfunction createStaticNodeDebugInfo(node: CompileNode): o.Expression {\n  const compileElement = node instanceof CompileElement ? node : null;\n  let providerTokens: o.Expression[] = [];\n  let componentToken: o.Expression = o.NULL_EXPR;\n  const varTokenEntries: any[] = [];\n  if (isPresent(compileElement)) {\n    providerTokens = compileElement.getProviderTokens();\n    if (isPresent(compileElement.component)) {\n      componentToken = createDiTokenExpression(identifierToken(compileElement.component.type));\n    }\n    Object.keys(compileElement.referenceTokens).forEach(varName => {\n      const token = compileElement.referenceTokens[varName];\n      varTokenEntries.push(\n          [varName, isPresent(token) ? createDiTokenExpression(token) : o.NULL_EXPR]);\n    });\n  }\n  return o.importExpr(resolveIdentifier(Identifiers.StaticNodeDebugInfo))\n      .instantiate(\n          [\n            o.literalArr(providerTokens, new o.ArrayType(o.DYNAMIC_TYPE, [o.TypeModifier.Const])),\n            componentToken,\n            o.literalMap(varTokenEntries, new o.MapType(o.DYNAMIC_TYPE, [o.TypeModifier.Const]))\n          ],\n          o.importType(\n              resolveIdentifier(Identifiers.StaticNodeDebugInfo), null, [o.TypeModifier.Const]));\n}\n\nfunction createViewClass(\n    view: CompileView, renderCompTypeVar: o.ReadVarExpr,\n    nodeDebugInfosVar: o.Expression): o.ClassStmt {\n  const viewConstructorArgs = [\n    new o.FnParam(\n        ViewConstructorVars.viewUtils.name, o.importType(resolveIdentifier(Identifiers.ViewUtils))),\n    new o.FnParam(\n        ViewConstructorVars.parentView.name,\n        o.importType(resolveIdentifier(Identifiers.AppView), [o.DYNAMIC_TYPE])),\n    new o.FnParam(ViewConstructorVars.parentIndex.name, o.NUMBER_TYPE),\n    new o.FnParam(ViewConstructorVars.parentElement.name, o.DYNAMIC_TYPE)\n  ];\n  const superConstructorArgs = [\n    o.variable(view.className), renderCompTypeVar, ViewTypeEnum.fromValue(view.viewType),\n    ViewConstructorVars.viewUtils, ViewConstructorVars.parentView, ViewConstructorVars.parentIndex,\n    ViewConstructorVars.parentElement,\n    ChangeDetectorStatusEnum.fromValue(getChangeDetectionMode(view))\n  ];\n  if (view.genConfig.genDebugInfo) {\n    superConstructorArgs.push(nodeDebugInfosVar);\n  }\n  if (view.viewType === ViewType.EMBEDDED) {\n    viewConstructorArgs.push(new o.FnParam(\n        'declaredViewContainer', o.importType(resolveIdentifier(Identifiers.ViewContainer))));\n    superConstructorArgs.push(o.variable('declaredViewContainer'));\n  }\n  const viewMethods = [\n    new o.ClassMethod(\n        'createInternal', [new o.FnParam(rootSelectorVar.name, o.STRING_TYPE)],\n        generateCreateMethod(view),\n        o.importType(resolveIdentifier(Identifiers.ComponentRef), [o.DYNAMIC_TYPE])),\n    new o.ClassMethod(\n        'injectorGetInternal',\n        [\n          new o.FnParam(InjectMethodVars.token.name, o.DYNAMIC_TYPE),\n          // Note: Can't use o.INT_TYPE here as the method in AppView uses number\n          new o.FnParam(InjectMethodVars.requestNodeIndex.name, o.NUMBER_TYPE),\n          new o.FnParam(InjectMethodVars.notFoundResult.name, o.DYNAMIC_TYPE)\n        ],\n        addReturnValuefNotEmpty(view.injectorGetMethod.finish(), InjectMethodVars.notFoundResult),\n        o.DYNAMIC_TYPE),\n    new o.ClassMethod(\n        'detectChangesInternal', [new o.FnParam(DetectChangesVars.throwOnChange.name, o.BOOL_TYPE)],\n        generateDetectChangesMethod(view)),\n    new o.ClassMethod('dirtyParentQueriesInternal', [], view.dirtyParentQueriesMethod.finish()),\n    new o.ClassMethod('destroyInternal', [], generateDestroyMethod(view)),\n    new o.ClassMethod('detachInternal', [], view.detachMethod.finish()),\n    generateVisitRootNodesMethod(view), generateVisitProjectableNodesMethod(view),\n    generateCreateEmbeddedViewsMethod(view)\n  ].filter((method) => method.body.length > 0);\n  const superClass = view.genConfig.genDebugInfo ? Identifiers.DebugAppView : Identifiers.AppView;\n\n  const viewClass = createClassStmt({\n    name: view.className,\n    parent: o.importExpr(resolveIdentifier(superClass), [getContextType(view)]),\n    parentArgs: superConstructorArgs,\n    ctorParams: viewConstructorArgs,\n    builders: [{methods: viewMethods}, view]\n  });\n  return viewClass;\n}\n\nfunction generateDestroyMethod(view: CompileView): o.Statement[] {\n  const stmts: o.Statement[] = [];\n  view.viewContainers.forEach((viewContainer) => {\n    stmts.push(viewContainer.callMethod('destroyNestedViews', []).toStmt());\n  });\n  view.viewChildren.forEach(\n      (viewChild) => { stmts.push(viewChild.callMethod('destroy', []).toStmt()); });\n  stmts.push(...view.destroyMethod.finish());\n  return stmts;\n}\n\nfunction generateCreateMethod(view: CompileView): o.Statement[] {\n  let parentRenderNodeExpr: o.Expression = o.NULL_EXPR;\n  let parentRenderNodeStmts: any[] = [];\n  if (view.viewType === ViewType.COMPONENT) {\n    parentRenderNodeExpr =\n        ViewProperties.renderer.callMethod('createViewRoot', [o.THIS_EXPR.prop('parentElement')]);\n    parentRenderNodeStmts =\n        [parentRenderNodeVar.set(parentRenderNodeExpr)\n             .toDeclStmt(\n                 o.importType(view.genConfig.renderTypes.renderNode), [o.StmtModifier.Final])];\n  }\n  let resultExpr: o.Expression;\n  if (view.viewType === ViewType.HOST) {\n    const hostEl = <CompileElement>view.nodes[0];\n    resultExpr =\n        o.importExpr(resolveIdentifier(Identifiers.ComponentRef_), [o.DYNAMIC_TYPE]).instantiate([\n          o.literal(hostEl.nodeIndex), o.THIS_EXPR, hostEl.renderNode, hostEl.getComponent()\n        ]);\n  } else {\n    resultExpr = o.NULL_EXPR;\n  }\n  const allNodesExpr: o.Expression =\n      ViewProperties.renderer.cast(o.DYNAMIC_TYPE)\n          .prop('directRenderer')\n          .conditional(o.NULL_EXPR, o.literalArr(view.nodes.map(node => node.renderNode)));\n\n  return parentRenderNodeStmts.concat(view.createMethod.finish(), [\n    o.THIS_EXPR\n        .callMethod(\n            'init',\n            [\n              view.lastRenderNode,\n              allNodesExpr,\n              view.disposables.length ? o.literalArr(view.disposables) : o.NULL_EXPR,\n            ])\n        .toStmt(),\n    new o.ReturnStatement(resultExpr)\n  ]);\n}\n\nfunction generateDetectChangesMethod(view: CompileView): o.Statement[] {\n  const stmts: any[] = [];\n  if (view.animationBindingsMethod.isEmpty() && view.detectChangesInInputsMethod.isEmpty() &&\n      view.updateContentQueriesMethod.isEmpty() &&\n      view.afterContentLifecycleCallbacksMethod.isEmpty() &&\n      view.detectChangesRenderPropertiesMethod.isEmpty() &&\n      view.updateViewQueriesMethod.isEmpty() && view.afterViewLifecycleCallbacksMethod.isEmpty() &&\n      view.viewContainers.length === 0 && view.viewChildren.length === 0) {\n    return stmts;\n  }\n  stmts.push(...view.animationBindingsMethod.finish());\n  stmts.push(...view.detectChangesInInputsMethod.finish());\n  view.viewContainers.forEach((viewContainer) => {\n    stmts.push(\n        viewContainer.callMethod('detectChangesInNestedViews', [DetectChangesVars.throwOnChange])\n            .toStmt());\n  });\n  const afterContentStmts = view.updateContentQueriesMethod.finish().concat(\n      view.afterContentLifecycleCallbacksMethod.finish());\n  if (afterContentStmts.length > 0) {\n    stmts.push(new o.IfStmt(o.not(DetectChangesVars.throwOnChange), afterContentStmts));\n  }\n  stmts.push(...view.detectChangesRenderPropertiesMethod.finish());\n  view.viewChildren.forEach((viewChild) => {\n    stmts.push(viewChild.callMethod('detectChanges', [DetectChangesVars.throwOnChange]).toStmt());\n  });\n  const afterViewStmts =\n      view.updateViewQueriesMethod.finish().concat(view.afterViewLifecycleCallbacksMethod.finish());\n  if (afterViewStmts.length > 0) {\n    stmts.push(new o.IfStmt(o.not(DetectChangesVars.throwOnChange), afterViewStmts));\n  }\n\n  const varStmts: any[] = [];\n  const readVars = o.findReadVarNames(stmts);\n  if (readVars.has(DetectChangesVars.changed.name)) {\n    varStmts.push(DetectChangesVars.changed.set(o.literal(true)).toDeclStmt(o.BOOL_TYPE));\n  }\n  if (readVars.has(DetectChangesVars.changes.name)) {\n    varStmts.push(\n        DetectChangesVars.changes.set(o.NULL_EXPR)\n            .toDeclStmt(new o.MapType(o.importType(resolveIdentifier(Identifiers.SimpleChange)))));\n  }\n  varStmts.push(...createSharedBindingVariablesIfNeeded(stmts));\n  return varStmts.concat(stmts);\n}\n\nfunction addReturnValuefNotEmpty(statements: o.Statement[], value: o.Expression): o.Statement[] {\n  if (statements.length > 0) {\n    return statements.concat([new o.ReturnStatement(value)]);\n  } else {\n    return statements;\n  }\n}\n\nfunction getContextType(view: CompileView): o.Type {\n  if (view.viewType === ViewType.COMPONENT) {\n    return o.importType(view.component.type);\n  }\n  return o.DYNAMIC_TYPE;\n}\n\nfunction getChangeDetectionMode(view: CompileView): ChangeDetectorStatus {\n  let mode: ChangeDetectorStatus;\n  if (view.viewType === ViewType.COMPONENT) {\n    mode = isDefaultChangeDetectionStrategy(view.component.changeDetection) ?\n        ChangeDetectorStatus.CheckAlways :\n        ChangeDetectorStatus.CheckOnce;\n  } else {\n    mode = ChangeDetectorStatus.CheckAlways;\n  }\n  return mode;\n}\n\nfunction generateVisitRootNodesMethod(view: CompileView): o.ClassMethod {\n  const cbVar = o.variable('cb');\n  const ctxVar = o.variable('ctx');\n  const stmts: o.Statement[] = generateVisitNodesStmts(view.rootNodes, cbVar, ctxVar);\n  return new o.ClassMethod(\n      'visitRootNodesInternal',\n      [new o.FnParam(cbVar.name, o.DYNAMIC_TYPE), new o.FnParam(ctxVar.name, o.DYNAMIC_TYPE)],\n      stmts);\n}\n\nfunction generateVisitProjectableNodesMethod(view: CompileView): o.ClassMethod {\n  const nodeIndexVar = o.variable('nodeIndex');\n  const ngContentIndexVar = o.variable('ngContentIndex');\n  const cbVar = o.variable('cb');\n  const ctxVar = o.variable('ctx');\n  const stmts: o.Statement[] = [];\n  view.nodes.forEach((node) => {\n    if (node instanceof CompileElement && node.component) {\n      node.contentNodesByNgContentIndex.forEach((projectedNodes, ngContentIndex) => {\n        stmts.push(new o.IfStmt(\n            nodeIndexVar.equals(o.literal(node.nodeIndex))\n                .and(ngContentIndexVar.equals(o.literal(ngContentIndex))),\n            generateVisitNodesStmts(projectedNodes, cbVar, ctxVar)));\n      });\n    }\n  });\n  return new o.ClassMethod(\n      'visitProjectableNodesInternal',\n      [\n        new o.FnParam(nodeIndexVar.name, o.NUMBER_TYPE),\n        new o.FnParam(ngContentIndexVar.name, o.NUMBER_TYPE),\n        new o.FnParam(cbVar.name, o.DYNAMIC_TYPE), new o.FnParam(ctxVar.name, o.DYNAMIC_TYPE)\n      ],\n      stmts);\n}\n\nfunction generateVisitNodesStmts(\n    nodes: CompileViewRootNode[], cb: o.Expression, ctx: o.Expression): o.Statement[] {\n  const stmts: o.Statement[] = [];\n  nodes.forEach((node) => {\n    switch (node.type) {\n      case CompileViewRootNodeType.Node:\n        stmts.push(cb.callFn([node.expr, ctx]).toStmt());\n        break;\n      case CompileViewRootNodeType.ViewContainer:\n        stmts.push(cb.callFn([node.expr.prop('nativeElement'), ctx]).toStmt());\n        stmts.push(node.expr.callMethod('visitNestedViewRootNodes', [cb, ctx]).toStmt());\n        break;\n      case CompileViewRootNodeType.NgContent:\n        stmts.push(\n            o.THIS_EXPR.callMethod('visitProjectedNodes', [o.literal(node.ngContentIndex), cb, ctx])\n                .toStmt());\n        break;\n    }\n  });\n  return stmts;\n}\n\nfunction generateCreateEmbeddedViewsMethod(view: CompileView): o.ClassMethod {\n  const nodeIndexVar = o.variable('nodeIndex');\n  const stmts: o.Statement[] = [];\n  view.nodes.forEach((node) => {\n    if (node instanceof CompileElement) {\n      if (node.embeddedView) {\n        const parentNodeIndex = node.isRootElement() ? null : node.parent.nodeIndex;\n        stmts.push(new o.IfStmt(\n            nodeIndexVar.equals(o.literal(node.nodeIndex)),\n            [new o.ReturnStatement(node.embeddedView.classExpr.instantiate([\n              ViewProperties.viewUtils, o.THIS_EXPR, o.literal(node.nodeIndex), node.renderNode,\n              node.viewContainer\n            ]))]));\n      }\n    }\n  });\n  if (stmts.length > 0) {\n    stmts.push(new o.ReturnStatement(o.NULL_EXPR));\n  }\n  return new o.ClassMethod(\n      'createEmbeddedViewInternal', [new o.FnParam(nodeIndexVar.name, o.NUMBER_TYPE)], stmts,\n      o.importType(resolveIdentifier(Identifiers.AppView), [o.DYNAMIC_TYPE]));\n}\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}